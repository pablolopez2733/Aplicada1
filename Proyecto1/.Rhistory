linea.mujeres <- read_csv("https://raw.githubusercontent.com/pablolopez2733/Aplicada1/master/Bases%20de%20Datos/linea-mujeres2.csv")
diccionario.linea <- read_csv("https://github.com/pablolopez2733/Aplicada1/raw/master/Bases%20de%20Datos/DiccionarioLineaMujeres.csv")
#Delitos en CDMX solamente
denuncias.cdmx <- linea.mujeres %>% filter(ESTADO_USUARIA=="CIUDAD DE MÉXICO")
#Gráfica de violín: edad vs delegación--------------------------------------------------------
violin <- ggplot(denuncias.cdmx, aes(x=MUNICIPIO_USUARIA, y=EDAD , fill=MUNICIPIO_USUARIA)) +
labs(x="Delegación",y="Edad de las usuarias",title="Densidad de edades para las usuarias por delegación")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
geom_violin()
violin + geom_boxplot(width=0.1)
rm(list = ls())
#Paquetes requeridos
library(tidyverse)
library(cowplot)
library(kableExtra)
library(knitr)
library(lubridate)
library(dplyr)
library(moments)
library(readr)
library(rgdal)
library(broom)
#Lectura de Datos y Diccionario------------------------------------------------------------
linea.mujeres <- read_csv("https://raw.githubusercontent.com/pablolopez2733/Aplicada1/master/Bases%20de%20Datos/linea-mujeres2.csv")
diccionario.linea <- read_csv("https://github.com/pablolopez2733/Aplicada1/raw/master/Bases%20de%20Datos/DiccionarioLineaMujeres.csv")
#Delitos en CDMX solamente
denuncias.cdmx <- linea.mujeres %>% filter(ESTADO_USUARIA=="CIUDAD DE MÉXICO")
#Gráfica de violín: edad vs delegación--------------------------------------------------------
violin <- ggplot(denuncias.cdmx, aes(x=MUNICIPIO_USUARIA, y=EDAD , fill=MUNICIPIO_USUARIA)) +
labs(x="Delegación",y="Edad de las usuarias",title="Densidad de edades para las usuarias por delegación")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
geom_violin()
violin + geom_boxplot(width=0.1)
nrow(denuncias.cdmx)
nrow(linea.mujeres)
#Prueba Tabla
num_cdmx <- nrow(denuncias.cdmx)
num_tot <- nrow(linea.mujeres)
llam_int <- num_tot-num_cdmx
origen <- c('Llamadas totales','Llamadas CDMX','Llamadas Interior de la República')
num_calls <- c(num_tot, num_cdmx, llam_int)
calls_df <- data.frame(origen, num_calls)
kable(calls_df, booktabs = T) %>% kable_styling(latex_options = "striped")
#Prueba tabla:
num_cdmx <- nrow(denuncias.cdmx)
num_tot <- nrow(linea.mujeres)
llam_int <- num_tot-num_cdmx
origen <- c('Llamadas totales','Llamadas CDMX','Llamadas Interior de la República')
denuncias <- c(num_tot, num_cdmx, llam_int)
porc_total=100
porc_cdmx <- (num_cdmx/num_tot)*100
porc_int <- 100-porc_cdmx
porcentaje <- c(porc_total,porc_cdmx,porc_int)
calls_df <- data.frame(origen, denuncias,porcentaje)
kable(calls_df, booktabs = T) %>% kable_styling(latex_options = "striped")
linea.mujeres.filtered<-filter(linea.mujeres, !is.na(TEMATICA_1), !is.na(ORIGEN), !is.na(SERVICIO), !is.na(ESCOLARIDAD), !is.na(ESTADO_CIVIL))
#Realizamos un Count Plot entre el Estado Civil y la ocupación
ggplot(linea.mujeres.filtered)+
geom_count(aes(x =ESTADO_CIVIL , y = OCUPACION), color = "darkblue", show.legend=TRUE) +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +
labs(subtitle="Estado Civil vs Ocupación",
y="Ocupación",
x="Estado Civil",
title="Gráfica de Conteo") +
theme(axis.text=element_text(size=7), axis.title=element_text(size=10,face="bold"))
#Realizamos un Bubble Plot
ggplot(linea.mujeres.filtered) +
geom_bar(aes(SERVICIO, fill = ORIGEN), width = 0.5) +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5), axis.text=element_text(size=7)) +
labs(
title = "Servicio Brindado en la Llamada a Linea Mujeres",
subtitle = "Por Origen de la Llamada",
x = "Servicio brindado",
y = "n"
)
tematica.escolaridad <- linea.mujeres.filtered %>%group_by(TEMATICA_1, ESCOLARIDAD, ESTADO_CIVIL) %>% count()
ggplot(tematica.escolaridad)+
labs(x = "Estado Civil",
y = " Tematica de la llamada",
title="Temática de la Lllamada por Estado Civil y Escolaridad") +
geom_jitter(aes(ESTADO_CIVIL, TEMATICA_1, size=n, color = ESCOLARIDAD)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5), axis.text=element_text(size=7)) +
facet_grid(cols = vars(ESCOLARIDAD))
#Realizamos un Bubble Plot
ggplot(linea.mujeres.filtered) +
geom_bar(aes(SERVICIO, fill = ORIGEN), width = 0.5) +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5), axis.text=element_text(size=7)) +
labs(
title = "Servicio Brindado en la Llamada a Linea Mujeres",
subtitle = "Por Origen de la Llamada",
x = "Servicio brindado",
y = "n"
)
R
install.packages(c("backports", "DT", "ggplot2", "htmltools", "isoband", "jsonlite", "knitr", "magick", "rmarkdown", "tinytex", "xfun"))
install.packages(c("backports", "DT", "ggplot2", "htmltools", "isoband", "jsonlite", "knitr", "magick", "rmarkdown", "tinytex", "xfun"))
install.packages(c("backports", "DT", "ggplot2", "htmltools", "isoband", "jsonlite", "knitr", "magick", "rmarkdown", "tinytex", "xfun"))
